(function(d){var a="ui-widget-multiselect",b=' class="'+a,h="ui-state-active",f='<li><a href="#">{l}</a></li>',c=d("body"),e,i,g;i=function(n,l,p){var k,j,m,o;n.appendTo(c).css("position","absolute");k=function(q){var r=!q.hasClass(h);q.toggleClass(h).data("option").selected=r;l()};n.click(function(r){r.preventDefault();var q=r.target;k(q.nodeName==="LI"?d(q):d(q).closest("li"))});c.click(function(r){if(!j){var q=d(r.target);if(q.closest("ul."+a+"-select").length===0){n.removeClass(h)}}else{j=false}});m=function(){j=true;n.css(p.offset()).addClass(h)};o=function(){n.removeClass(h)};return{open:m,shut:o}};g=function(o,n){var m=o[0].options,j=[],p,k;for(p=0,k=m.length;p<k;p++){if(m[p].selected){j.push(d(m[p]).text())}}n.text(j.join(", "))};e=function(n){var k=d(["<div",b,'">',"<a",b,'-add"><span>Add...</span></a>',"<ul",b,'-select"></ul>',"<p",b,'-list"></p>',"</div>"].join("")),o=k.children("ul."+a+"-select:first"),m=k.children("."+a+"-list:first"),j=n.children("option"),p=k.children("a."+a+"-add:first"),l;j.each(function(){d(f.replace("{l}",this.innerHTML)).data("option",this).appendTo(o)});k.insertBefore(n);n.css({position:"absolute",left:"-999em"});l=i(o,function(){g(n,m)},p);p.click(function(q){q.preventDefault();l.open()});g(n,m)};d.fn.tinyMS=function(){this.each(function(){e(d(this))});return this}}(window.jQuery));

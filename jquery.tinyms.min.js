(function(f){var g="ui-widget-multiselect",b=' class="'+g,d="ui-state-active",a='<li><a href="#">{l}</a></li>',e,c,h;c=function(m,k,o){var j,i,l,n;m.appendTo("body").css("position","absolute");j=function(p){var q=!p.hasClass(d);p.toggleClass(d).data("option").selected=q;k()};m.click(function(q){q.preventDefault();var p=q.target;j(p.nodeName==="LI"?f(p):f(p).closest("li"))});f(document).click(function(q){if(!i){var p=f(q.target);if(p.closest("ul."+g+"-select").length===0){m.removeClass(d)}}else{i=false}});l=function(){i=true;m.css(o.offset()).addClass(d)};n=function(){m.removeClass(d)};return{open:l,shut:n}};h=function(o,n){var m=o[0].options,j=[],p,k;for(p=0,k=m.length;p<k;p++){if(m[p].selected){j.push(f(m[p]).text())}}n.text(j.join(", "))};e=function(m){var j=f(["<div",b,'">','<a href="#"',b,'-add"><span>Add...</span></a>',"<ul",b,'-select"></ul>',"<p",b,'-list"></p>',"</div>"].join("")),n=j.children("ul."+g+"-select:first"),l=j.children("."+g+"-list:first"),i=m.children("option"),o=j.children("a."+g+"-add:first"),k;i.each(function(){f(a.replace("{l}",this.innerHTML)).data("option",this).appendTo(n)});j.insertBefore(m);m.css({position:"absolute",left:"-999em"});k=c(n,function(){h(m,l)},o);o.click(function(p){p.preventDefault();k.open()});h(m,l)};f.fn.tinyMS=function(){this.each(function(){e(f(this))});return this}}(window.jQuery));
